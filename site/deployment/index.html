
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.4">
    
    
      
        <title>Deployment - Cloud Custodian Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.f7f47774.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#deployment" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Cloud Custodian Documentation" class="md-header__button md-logo" aria-label="Cloud Custodian Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cloud Custodian Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Deployment
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Cloud Custodian Documentation" class="md-nav__button md-logo" aria-label="Cloud Custodian Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Cloud Custodian Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../actions/" class="md-nav__link">
        Actions
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contribute/" class="md-nav__link">
        Contribute
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Deployment
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Deployment
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#compliance-as-code-compliance_as_code" class="md-nav__link">
    Compliance as Code {#compliance_as_code}
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#continuous-integration-of-policies-continuous_integration_of_policies" class="md-nav__link">
    Continuous Integration of Policies {#continuous_integration_of_policies}
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iam-setup-iam_setup" class="md-nav__link">
    IAM Setup {#iam_setup}
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#single-node-deployment-single_node_usage" class="md-nav__link">
    Single Node Deployment {#single_node_usage}
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring-cloud-custodian-monitoring_custodian" class="md-nav__link">
    Monitoring Cloud Custodian {#monitoring_custodian}
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mailer-and-notifications-deployment-mailer_and_notifications_deployment" class="md-nav__link">
    Mailer and Notifications Deployment {#mailer_and_notifications_deployment}
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-account-execution-multi_account_execution" class="md-nav__link">
    Multi Account Execution {#multi_account_execution}
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-continuous-integration-tips-advanced_continuous_integration_tips" class="md-nav__link">
    Advanced Continuous Integration Tips {#advanced_continuous_integration_tips}
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-resources-additional_resources" class="md-nav__link">
    Additional Resources {#additional_resources}
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../filters/" class="md-nav__link">
        Filters
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Aws
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Aws" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Aws
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/contribute/" class="md-nav__link">
        Contribute
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/contribute.rst/" class="md-nav__link">
        Contribute.rst
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/gettingstarted/" class="md-nav__link">
        Gettingstarted
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/gettingstarted.rst/" class="md-nav__link">
        Gettingstarted.rst
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/lambda/" class="md-nav__link">
        Lambda
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/lambda.rst/" class="md-nav__link">
        Lambda.rst
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/usage/" class="md-nav__link">
        Usage
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/usage.rst/" class="md-nav__link">
        Usage.rst
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_9" type="checkbox" id="__nav_6_9" >
      
      <label class="md-nav__link" for="__nav_6_9">
        Examples
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Examples" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_9">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/" class="md-nav__link">
        Index
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/accountinvalidiplogin/" class="md-nav__link">
        Accountinvalidiplogin
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/accountrootlogin/" class="md-nav__link">
        Accountrootlogin
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/accountservicelimit/" class="md-nav__link">
        Accountservicelimit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/amicomp/" class="md-nav__link">
        Amicomp
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/asginvalidconfig/" class="md-nav__link">
        Asginvalidconfig
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/asgnotused/" class="md-nav__link">
        Asgnotused
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/asgoffhours/" class="md-nav__link">
        Asgoffhours
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/blocknonstandardregionresources/" class="md-nav__link">
        Blocknonstandardregionresources
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/dmsenforcessl/" class="md-nav__link">
        Dmsenforcessl
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/ebsgarbagecollect/" class="md-nav__link">
        Ebsgarbagecollect
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/ebssnapshots/" class="md-nav__link">
        Ebssnapshots
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/ebsunencrypted/" class="md-nav__link">
        Ebsunencrypted
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/ec2-auto-tag-user/" class="md-nav__link">
        Ec2 auto tag user
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/ec2offhours/" class="md-nav__link">
        Ec2offhours
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/ec2oldinstances/" class="md-nav__link">
        Ec2oldinstances
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/ec2poweronstoppedforpatching/" class="md-nav__link">
        Ec2poweronstoppedforpatching
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/ec2unpatchedworkflow/" class="md-nav__link">
        Ec2unpatchedworkflow
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/eipgarbagecollect/" class="md-nav__link">
        Eipgarbagecollect
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/elbdeleteinetfacing/" class="md-nav__link">
        Elbdeleteinetfacing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/elbgarbagecollection/" class="md-nav__link">
        Elbgarbagecollection
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/elbsslblacklist/" class="md-nav__link">
        Elbsslblacklist
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/elbsslwhitelist/" class="md-nav__link">
        Elbsslwhitelist
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/iamsetrolepolicy/" class="md-nav__link">
        Iamsetrolepolicy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/lambdaerrorsnotify/" class="md-nav__link">
        Lambdaerrorsnotify
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/offhours/" class="md-nav__link">
        Offhours
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/rdsdeleteunused/" class="md-nav__link">
        Rdsdeleteunused
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/rdspublicunencrypted/" class="md-nav__link">
        Rdspublicunencrypted
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/s3configurenewbucket/" class="md-nav__link">
        S3configurenewbucket
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/s3denypublicobjectacls/" class="md-nav__link">
        S3denypublicobjectacls
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/s3encryption/" class="md-nav__link">
        S3encryption
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/s3globalgrants/" class="md-nav__link">
        S3globalgrants
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/sagemakernotebookdeletepublicorunencrypted/" class="md-nav__link">
        Sagemakernotebookdeletepublicorunencrypted
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/securitygroupsaddpermission/" class="md-nav__link">
        Securitygroupsaddpermission
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/securitygroupsdetectremediate/" class="md-nav__link">
        Securitygroupsdetectremediate
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/tagcompliance/" class="md-nav__link">
        Tagcompliance
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/vpcflowlog/" class="md-nav__link">
        Vpcflowlog
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/examples/vpcpeeringcrossaccount/" class="md-nav__link">
        Vpcpeeringcrossaccount
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_10" type="checkbox" id="__nav_6_10" >
      
      <label class="md-nav__link" for="__nav_6_10">
        Topics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Topics" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_10">
          <span class="md-nav__icon md-icon"></span>
          Topics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/topics/" class="md-nav__link">
        Index
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/topics/config/" class="md-nav__link">
        Config
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/topics/securityhub/" class="md-nav__link">
        Securityhub
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/topics/ssm/" class="md-nav__link">
        Ssm
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../aws/topics/xray/" class="md-nav__link">
        Xray
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Azure
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Azure" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Azure
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/gettingstarted/" class="md-nav__link">
        Gettingstarted
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/gettingstarted.rst/" class="md-nav__link">
        Gettingstarted.rst
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_3" type="checkbox" id="__nav_7_3" >
      
      <label class="md-nav__link" for="__nav_7_3">
        Advanced
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Advanced" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_3">
          <span class="md-nav__icon md-icon"></span>
          Advanced
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/advanced/" class="md-nav__link">
        Index
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/advanced/azurepolicy/" class="md-nav__link">
        Azurepolicy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/advanced/contribute/" class="md-nav__link">
        Contribute
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/advanced/multiplesubs/" class="md-nav__link">
        Multiplesubs
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_4" type="checkbox" id="__nav_7_4" >
      
      <label class="md-nav__link" for="__nav_7_4">
        Configuration
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Configuration" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_4">
          <span class="md-nav__icon md-icon"></span>
          Configuration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/configuration/" class="md-nav__link">
        Index
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/configuration/acitutorial/" class="md-nav__link">
        Acitutorial
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/configuration/authentication/" class="md-nav__link">
        Authentication
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/configuration/containerhosting/" class="md-nav__link">
        Containerhosting
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/configuration/functionshosting/" class="md-nav__link">
        Functionshosting
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/configuration/helmtutorial/" class="md-nav__link">
        Helmtutorial
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/configuration/monitoring/" class="md-nav__link">
        Monitoring
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_5" type="checkbox" id="__nav_7_5" >
      
      <label class="md-nav__link" for="__nav_7_5">
        Examples
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Examples" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_5">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/" class="md-nav__link">
        Index
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/appservicecors-compute/" class="md-nav__link">
        Appservicecors compute
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/appserviceplansresize-compute/" class="md-nav__link">
        Appserviceplansresize compute
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/cosmosdb-collection-on-off-hours-databases/" class="md-nav__link">
        Cosmosdb collection on off hours databases
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/emailnotify-notifications/" class="md-nav__link">
        Emailnotify notifications
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/firewall-cosmosaction-networking/" class="md-nav__link">
        Firewall cosmosaction networking
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/firewall-rulesfiltering-networking/" class="md-nav__link">
        Firewall rulesfiltering networking
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/loadbalancerfilterbyfrotendip-networking/" class="md-nav__link">
        Loadbalancerfilterbyfrotendip networking
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/metrics-general/" class="md-nav__link">
        Metrics general
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/networksecuritygroups-networking/" class="md-nav__link">
        Networksecuritygroups networking
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/resourcegroupsdelayedoperation-general/" class="md-nav__link">
        Resourcegroupsdelayedoperation general
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/resourcegroupsorphanresources-general-compute-networking/" class="md-nav__link">
        Resourcegroupsorphanresources general compute networking
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/resourcegroupsremoveempty-general/" class="md-nav__link">
        Resourcegroupsremoveempty general
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/routetablewithsubnet-networking/" class="md-nav__link">
        Routetablewithsubnet networking
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/sqldatabasebackupretention-databases/" class="md-nav__link">
        Sqldatabasebackupretention databases
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/sqldatabaseupdateretentionpolicies-databases/" class="md-nav__link">
        Sqldatabaseupdateretentionpolicies databases
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/sqldatabasewithpremiumsku-databases/" class="md-nav__link">
        Sqldatabasewithpremiumsku databases
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/storageaddfirewallrulestostorage-databases-networking/" class="md-nav__link">
        Storageaddfirewallrulestostorage databases networking
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/storageblockpublicaccess-networking-databases/" class="md-nav__link">
        Storageblockpublicaccess networking databases
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/storagecontainerevent-databases/" class="md-nav__link">
        Storagecontainerevent databases
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/tagadd-general-compute/" class="md-nav__link">
        Tagadd general compute
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/tagautotagusers-general-identity/" class="md-nav__link">
        Tagautotagusers general identity
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/tagremove-general-compute/" class="md-nav__link">
        Tagremove general compute
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/tagtrim-general-compute/" class="md-nav__link">
        Tagtrim general compute
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/teamsnewresourcegroup-general-notifications/" class="md-nav__link">
        Teamsnewresourcegroup general notifications
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/virtualmachinesstoppedvm-compute/" class="md-nav__link">
        Virtualmachinesstoppedvm compute
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/virtualmachineswithpublicip-compute-networking/" class="md-nav__link">
        Virtualmachineswithpublicip compute networking
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_5_28" type="checkbox" id="__nav_7_5_28" >
      
      <label class="md-nav__link" for="__nav_7_5_28">
        Logicappnotifications
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Logicappnotifications" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_5_28">
          <span class="md-nav__icon md-icon"></span>
          Logicappnotifications
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../azure/examples/logicappnotifications/logicappnotification/" class="md-nav__link">
        Logicappnotification
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        Developer
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Developer" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Developer
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../developer/" class="md-nav__link">
        Index
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../developer/documentation/" class="md-nav__link">
        Documentation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../developer/documentation.rst/" class="md-nav__link">
        Documentation.rst
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../developer/index.rst/" class="md-nav__link">
        Index.rst
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../developer/installing/" class="md-nav__link">
        Installing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../developer/installing.rst/" class="md-nav__link">
        Installing.rst
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../developer/packaging/" class="md-nav__link">
        Packaging
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../developer/packaging.rst/" class="md-nav__link">
        Packaging.rst
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../developer/tests/" class="md-nav__link">
        Tests
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../developer/tests.rst/" class="md-nav__link">
        Tests.rst
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      <label class="md-nav__link" for="__nav_9">
        Gcp
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Gcp" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Gcp
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/contribute/" class="md-nav__link">
        Contribute
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/contribute.rst/" class="md-nav__link">
        Contribute.rst
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/gettingstarted/" class="md-nav__link">
        Gettingstarted
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/gettingstarted.rst/" class="md-nav__link">
        Gettingstarted.rst
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_5" type="checkbox" id="__nav_9_5" >
      
      <label class="md-nav__link" for="__nav_9_5">
        Examples
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Examples" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_5">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/" class="md-nav__link">
        Index
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/appengine-certificates/" class="md-nav__link">
        Appengine certificates
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/appengine-domain/" class="md-nav__link">
        Appengine domain
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/appengine-firewall-ingress-rule/" class="md-nav__link">
        Appengine firewall ingress rule
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/dataflow-job/" class="md-nav__link">
        Dataflow job
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/dm-deployments/" class="md-nav__link">
        Dm deployments
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/dns-managed-zone/" class="md-nav__link">
        Dns managed zone
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/dns-policy/" class="md-nav__link">
        Dns policy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/gce-autoscaler/" class="md-nav__link">
        Gce autoscaler
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/gce-instance-template/" class="md-nav__link">
        Gce instance template
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/kms-cryptokey/" class="md-nav__link">
        Kms cryptokey
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/loadbalancer-delete-backend-buckets/" class="md-nav__link">
        Loadbalancer delete backend buckets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/loadbalancer-network-tiers/" class="md-nav__link">
        Loadbalancer network tiers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/loadbalancer-ssl-policy-delete-old-versions/" class="md-nav__link">
        Loadbalancer ssl policy delete old versions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/pubsub-snapshots/" class="md-nav__link">
        Pubsub snapshots
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/pubsub-subscriptions/" class="md-nav__link">
        Pubsub subscriptions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/spanner-drop-databases/" class="md-nav__link">
        Spanner drop databases
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/spanner-reduce-instances-count/" class="md-nav__link">
        Spanner reduce instances count
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/spanner-set-iam-policy/" class="md-nav__link">
        Spanner set iam policy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/sql-backupruns/" class="md-nav__link">
        Sql backupruns
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/sql-instance/" class="md-nav__link">
        Sql instance
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/sql-sslcerts/" class="md-nav__link">
        Sql sslcerts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/examples/sql-users/" class="md-nav__link">
        Sql users
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_6" type="checkbox" id="__nav_9_6" >
      
      <label class="md-nav__link" for="__nav_9_6">
        Policy
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Policy" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_6">
          <span class="md-nav__icon md-icon"></span>
          Policy
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/policy/" class="md-nav__link">
        Index
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/policy/genericgcpactions/" class="md-nav__link">
        Genericgcpactions
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_6_3" type="checkbox" id="__nav_9_6_3" >
      
      <label class="md-nav__link" for="__nav_9_6_3">
        Resources
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Resources" data-md-level="3">
        <label class="md-nav__title" for="__nav_9_6_3">
          <span class="md-nav__icon md-icon"></span>
          Resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/policy/resources/loadbalancer/" class="md-nav__link">
        Loadbalancer
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      <label class="md-nav__link" for="__nav_10">
        Quickstart
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Quickstart" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Quickstart
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/" class="md-nav__link">
        Index
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/advanced/" class="md-nav__link">
        Advanced
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/advanced.rst/" class="md-nav__link">
        Advanced.rst
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/index.rst/" class="md-nav__link">
        Index.rst
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/policyStructure/" class="md-nav__link">
        policyStructure
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/policyStructure.rst/" class="md-nav__link">
        policyStructure.rst
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#compliance-as-code-compliance_as_code" class="md-nav__link">
    Compliance as Code {#compliance_as_code}
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#continuous-integration-of-policies-continuous_integration_of_policies" class="md-nav__link">
    Continuous Integration of Policies {#continuous_integration_of_policies}
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iam-setup-iam_setup" class="md-nav__link">
    IAM Setup {#iam_setup}
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#single-node-deployment-single_node_usage" class="md-nav__link">
    Single Node Deployment {#single_node_usage}
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring-cloud-custodian-monitoring_custodian" class="md-nav__link">
    Monitoring Cloud Custodian {#monitoring_custodian}
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mailer-and-notifications-deployment-mailer_and_notifications_deployment" class="md-nav__link">
    Mailer and Notifications Deployment {#mailer_and_notifications_deployment}
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-account-execution-multi_account_execution" class="md-nav__link">
    Multi Account Execution {#multi_account_execution}
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-continuous-integration-tips-advanced_continuous_integration_tips" class="md-nav__link">
    Advanced Continuous Integration Tips {#advanced_continuous_integration_tips}
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-resources-additional_resources" class="md-nav__link">
    Additional Resources {#additional_resources}
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="deployment">Deployment</h1>
<p>In this section we will cover a few different deployment options for
Cloud Custodian.</p>
<h2 id="compliance-as-code-compliance_as_code">Compliance as Code {#compliance_as_code}</h2>
<p>When operating Cloud Custodian, it is highly recommended to treat the
policy files as code, similar to that of Terraform or CloudFormation
files. Cloud Custodian has a built-in dryrun mode and policy syntax
validation which when paired with an automated CI system, can help you
release policies with confidence.</p>
<p>This tutorial assumes that you have working knowledge of Github, Git,
Docker, and a continuous integration tool (Jenkins, Drone, Travis,
etc.).</p>
<p>To begin, start by checking your policy files into a source control
management tool like Github. This allows us to version and enable
collaboration through git pull requests and issues. In this example, we
will be setting up a new repo in Github.</p>
<p>First, set up a new repo in Github and grab the repository url. You
don\'t need to add a README or any other files to it first.</p>
<pre><code class="language-bash">mkdir my-policies
cd my-policies
git init
git remote add origin &lt;github repo url&gt;
touch policy.yml
</code></pre>
<p>Next, we\'ll add a policy to our new <code>policy.yml</code> file.</p>
<pre><code class="language-yaml">policies:
  - name: aws-vpcs
    resource: aws.vpc
</code></pre>
<p>Once you\'ve added the policy to your policy file we can stage our
changes from our working directory and push it up to our remote:</p>
<pre><code class="language-bash"># this should show your policy.yml as an untracked file
git status

git add policy.yml
git commit -m 'init my first policy'
git push -u origin master
</code></pre>
<p>Once you\'ve pushed your changes you should be able to see your new
changes inside of Github. Congratulations, you\'re now ready to start
automatically validating and testing your policies!</p>
<h2 id="continuous-integration-of-policies-continuous_integration_of_policies">Continuous Integration of Policies {#continuous_integration_of_policies}</h2>
<p>Next, enable a CI webhook back to your CI system of choice when pull
requests targeting your master branch are opened or updated. This allows
us to continuously test and validate the policies that are being
modified.</p>
<p>In this example, we will be using Microsoft Azure Devops Pipelines.</p>
<p>First, navigate to
<a href="https://azure.microsoft.com/en-us/services/devops/pipelines/">https://azure.microsoft.com/en-us/services/devops/pipelines/</a> and click
the \"Start pipelines free with Github\" button and follow the flow to
connect your Github account with Devops Pipelines.</p>
<p>Next click on the Pipelines section in the left hand side of the sidebar
and connect with Github. Once the pipeline is setup, we can add the
following azure devops configuration to our repo:</p>
<pre><code class="language-yaml">trigger:
- master

jobs:
  - job: 'Validate'
    pool:
      vmImage: 'Ubuntu-16.04'
    steps:
      - checkout: self
      - task: UsePythonVersion@0
        displayName: &quot;Set Python Version&quot;
        inputs:
          versionSpec: '3.7'
          architecture: 'x64'
      - script: pip install --upgrade pip
        displayName: Upgrade pip
      - script: pip install c7n c7n_azure c7n_gcp
        displayName: Install custodian
      - script: custodian validate policy.yml
        displayName: Validate policy file
</code></pre>
<p>This configuration will install Cloud Custodian and validate the
policy.yml file that we created in the previous step.</p>
<p>Finally, we can run the new policies against your cloud environment in
dryrun mode. This mode will only query the resources and apply the
filters on the resources. Doing this allows you to assess the potential
blast radius of a given policy change.</p>
<p>Setting up the automated dryrun of policies is left as an exercise to
the user-- this requires hosting your cloud authentication tokens
inside of a CI system or hosting your own CI system and using Managed
Service Identities (Azure) or Instance Profiles (AWS).</p>
<p>It\'s important to verify that the results of the dryrun match your
expectations. Custodian is a very powerful tool that will do exactly
what you tell it to do! In this case, you should always \"measure twice,
cut once\".</p>
<h2 id="iam-setup-iam_setup">IAM Setup {#iam_setup}</h2>
<p>To run Cloud Custodian against your account, you will need an IAM role
with appropriate permissions. Depending on the scope of the policy,
these permissions may differ from policy to policy. For a baseline, the
managed read only policies in each of the respective cloud providers
will be enough to dryrun your policies. Actions will require additional
IAM permissions which should be added at your discretion.</p>
<p>For serverless policies, Custodian will need the corresponding
permissions to provision serverless functions.</p>
<p>In AWS, you will need ReadOnly access as well as the following
permissions:</p>
<pre><code class="language-json">{
    &quot;Version&quot;: &quot;2012-10-17&quot;,
    &quot;Statement&quot;: [
        {
            &quot;Sid&quot;: &quot;CustodianLambdaPermissions&quot;,
            &quot;Effect&quot;: &quot;Allow&quot;,
            &quot;Action&quot;: [
                &quot;cloudwatch:PutMetricData&quot;,
                &quot;ec2:DescribeNetworkInterfaces&quot;,
                &quot;ec2:DeleteNetworkInterface&quot;,
                &quot;ec2:CreateNetworkInterface&quot;,
                &quot;events:PutRule&quot;,
                &quot;events:PutTargets&quot;,
                &quot;iam:PassRole&quot;,
                &quot;lambda:CreateFunction&quot;,
                &quot;lambda:TagResource&quot;,
                &quot;lambda:CreateEventSourceMapping&quot;,
                &quot;lambda:UntagResource&quot;,
                &quot;lambda:PutFunctionConcurrency&quot;,
                &quot;lambda:DeleteFunction&quot;,
                &quot;lambda:UpdateEventSourceMapping&quot;,
                &quot;lambda:InvokeFunction&quot;,
                &quot;lambda:UpdateFunctionConfiguration&quot;,
                &quot;lambda:UpdateAlias&quot;,
                &quot;lambda:UpdateFunctionCode&quot;,
                &quot;lambda:AddPermission&quot;,
                &quot;lambda:DeleteAlias&quot;,
                &quot;lambda:DeleteFunctionConcurrency&quot;,
                &quot;lambda:DeleteEventSourceMapping&quot;,
                &quot;lambda:RemovePermission&quot;,
                &quot;lambda:CreateAlias&quot;,
                &quot;logs:CreateLogStream&quot;,
                &quot;logs:PutLogEvents&quot;,
                &quot;logs:CreateLogGroup&quot;
            ],
            &quot;Resource&quot;: &quot;*&quot;
        }
    ]
}
</code></pre>
<p>Note: These are just the permissions to deploy Custodian Lambda
functions, these are not the permissions that are required to run
Custodian _<a href="">in</a> the Lambda function. Those roles are defined in the
role attribute in the policy or with the assume role used in the cli.</p>
<h2 id="single-node-deployment-single_node_usage">Single Node Deployment {#single_node_usage}</h2>
<p>Now that your policies are stored and available in source control, you
can now fill in the next pieces of the puzzle to deploy. The simplest
way to operate Cloud Custodian is to start with running Cloud Custodian
against a single account (or subscription or project) on a virtual
machine.</p>
<p>To start, create a virtual machine on your cloud provider of choice.
It\'s recommended to execute Cloud Custodian in the same cloud provider
that you are operating against to prevent a hard dependency on one cloud
to another as well being able to utilize your cloud\'s best practices
for credentials (instance profile, service account, etc).</p>
<p>Then, log into the instance and set up Custodian, following the
instructions in the <code>install-cc</code>{.interpreted-text role="ref"} guide.</p>
<p>Once you have Cloud Custodian installed, download your policies that you
created in the <code>compliance_as_code</code>{.interpreted-text role="ref"}
section. If using git, just simply do a <code>git clone</code>:</p>
<pre><code>git clone &lt;repository-url&gt;
</code></pre>
<p>You now have your policies and custodian available on the instance.
Typically, policies that query the extant resources in the
account/project/subscription should be run on a regular basis to ensure
that resources are constantly compliant. To do this you can simply set
up a cron job to run custodian on a set cadence.</p>
<h2 id="monitoring-cloud-custodian-monitoring_custodian">Monitoring Cloud Custodian {#monitoring_custodian}</h2>
<p>Cloud Custodian ships with the ability to emit metrics on policy
execution and transport logs to cloud provider native logging solutions.</p>
<p>When executing Custodian, you can enable metrics simply by adding the
<code>-m</code> flag and the cloud provider:</p>
<pre><code># AWS
custodian run -s output -m aws policy.yml

# Azure
custodian run -s output -m azure policy.yml

# GCP
custodian run -s output -m gcp policy.yml
</code></pre>
<p>When you enable metrics, a new namespace will be created and the
following metrics will be recorded there:</p>
<ul>
<li>ResourceCount</li>
<li>ResourceTime</li>
<li>ActionTime</li>
</ul>
<p>To enable logging to CloudWatch logs, Stackdriver, or Azure AppInsights,
use the <code>-l</code> flag:</p>
<pre><code># AWS CloudWatch Logs
custodian run -s output -l /cloud-custodian/policies policy.yml

# Azure App Insights Logs
custodian run -s output -l azure://cloud-custodian/policies policy.yml

# Stackdriver Logs
custodian run -s output -l gcp://cloud-custodian/policies policy.yml
</code></pre>
<p>You can also store the output of your Custodian logs in a cloud
provider\'s blob storage like S3 or Azure Storage accounts:</p>
<pre><code># AWS S3
custodian run -s s3://my-custodian-bucket policy.yml

# Azure Storage Accounts
custodian run -s azure://my-custodian-storage-account policy.yml
</code></pre>
<h2 id="mailer-and-notifications-deployment-mailer_and_notifications_deployment">Mailer and Notifications Deployment {#mailer_and_notifications_deployment}</h2>
<p>For instructions on how to deploy the mailer for notifications, see
<code>/tools/c7n-mailer</code>{.interpreted-text role="doc"}</p>
<h2 id="multi-account-execution-multi_account_execution">Multi Account Execution {#multi_account_execution}</h2>
<p>For more advanced setups, such as executing Custodian against multiple
accounts, we distribute the tool c7n-org. c7n-org utilizes a accounts
configuration file and assume roles to operate against multiple
accounts, projects, or subscriptions in parallel. More information can
be found in <code>/tools/c7n-org</code>{.interpreted-text role="doc"}.</p>
<h2 id="advanced-continuous-integration-tips-advanced_continuous_integration_tips">Advanced Continuous Integration Tips {#advanced_continuous_integration_tips}</h2>
<p>When policy files reach a sufficiently large size it can cause dryruns
to execute for a significantly long period of time. In most cases, the
only thing that actually needs to be tested would be the policies that
were changed.</p>
<p>The following example will download the cloudcustodian/policystream
image and generate a policy file containing only the policies that
changed between the most recent commit and master.</p>
<pre><code class="language-bash"># in your git directory for policies
docker pull cloudcustodian/policystream
docker run -v $(pwd):/home/custodian/policies cloudcustodian &gt; policystream-diff.yml
custodian run -s output -v --dryrun policystream-diff.yml
</code></pre>
<p>After running your new policy file (policystream-diff.yml), the outputs
will be stored in the output directory.</p>
<h2 id="additional-resources-additional_resources">Additional Resources {#additional_resources}</h2>
<ul>
<li><a href="https://github.com/manheim/manheim-c7n-tools">manheim-c7n-tools</a> -
    Manheim\'s Cloud Custodian (c7n) wrapper package, policy
    generator/interpolator, runner, error scanner, and supporting tools.</li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../contribute/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Contribute" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Contribute
            </div>
          </div>
        </a>
      
      
        
        <a href="../filters/" class="md-footer__link md-footer__link--next" aria-label="Next: Filters" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Filters
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.709b4209.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.febc23d1.min.js"></script>
      
    
  </body>
</html>